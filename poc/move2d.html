<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Leere Seite</title>
    <script>


        document.addEventListener("DOMContentLoaded", function () {
            console.log("Die Seite ist geladen!");
            const canvas = document.getElementById("game");
            const ctx = canvas.getContext("2d");

            // Sprite-Sheet laden
            const sprite = new Image();
            sprite.src = "contra clone character sprite sheet.png";  // 6 Frames nebeneinander

            // Sprite-Einstellungen
            const FRAME_WIDTH = 600;   // Breite eines Frames
            const FRAME_HEIGHT = 300;  // Höhe eines Frames
            const FRAME_COUNT = 1;     // Anzahl der Frames

            let frame = 0;             // Welches Frame gerade?
            let x = 10;                // Startposition
            let y = 10;
            let speed = 3;             // Laufgeschwindigkeit
            let frameTimer = 0;        // Zeitmessung für Framewechsel

            // Sprite-Sheet laden
            const spriteRun = new Image();
            spriteRun.src = "contra clone character sprite sheet.png"; // Laufanimation

            let movingLeft = false;
            let movingRight = false;
            let movingDown=false;
            let movingUp=false;

            console.log("canv img w, h", canvas, canvas.width, sprite, sprite.width), sprite.getWidth()
            const max_x = canvas.width - sprite.width; 

            function update() { 
                // Bewegung
                if (movingRight && x<800) x += speed;
                if (movingLeft) x -= speed;
                if (movingDown) y += speed;
                if (movingUp) y -= speed;

                // Framewechsel nur während Bewegung
                if (movingLeft || movingRight || movingDown || movingUp ) {
                    frameTimer++; 
                    if (frameTimer % 5 === 0) {
                        frame = (frame + 1) % FRAME_COUNT;
                    }
                } else {
                    frame = 0; // Standbild
                }
            }

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
// console.log("paint x,y,frame", x,y,frame)
                if (movingLeft || movingRight || movingDown || movingUp ) {
                    // Laufanimation
                    ctx.drawImage(
                        spriteRun,
                        frame * FRAME_WIDTH, 0,
                        FRAME_WIDTH, FRAME_HEIGHT,
                        x, y,
                        FRAME_WIDTH / 2, FRAME_HEIGHT / 2
                    );
                } else {
                    // Idle
                    ctx.drawImage(
                        spriteRun,
                        0, 0,                      // erstes Frame im Sprite-Sheet
                        FRAME_WIDTH, FRAME_HEIGHT,  // Ausschnittgröße
                        x, y,
                        FRAME_WIDTH / 2, FRAME_HEIGHT / 2 // gezeichnete Größe
                    );
                }
            }

            function loop() {
                update();
                draw();
                requestAnimationFrame(loop);
            }

            loop();

            // Tastatur-Events
            document.addEventListener("keydown", (e) => {
                if (e.key === "ArrowRight") movingRight = true;
                if (e.key === "ArrowLeft") movingLeft = true;
                if (e.key === "ArrowDown") movingDown = true;
                if (e.key === "ArrowUp") movingUp = true;
            });

            document.addEventListener("keyup", (e) => {
                if (e.key === "ArrowRight") movingRight = false;
                if (e.key === "ArrowLeft") movingLeft = false;
                if (e.key === "ArrowDown") movingDown = false;
                if (e.key === "ArrowUp") movingUp = false;
            });
        });  
    </script>
    <style>
        #game {
            background: lightblue; /* Farbe */
        }
    </style>
</head>


<body>
    <canvas id="game" width="1000" height="500"></canvas>
</body>

</html>     